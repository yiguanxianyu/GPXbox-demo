(function(){"use strict";var t={2566:function(t,e,n){var i=n(9242),s=n(3396),a=n(4870),r=n(3153),o=n.n(r);n(2640),n(9500);o().Polyline.include({_snakingTimestamp:0,_snakingRings:0,_snakingVertices:0,_snakingDistance:0,_snaking:!1,snakeIn:function(){if(window.i=0,!this._snaking&&"performance"in window&&"now"in window.performance&&this._map)return this._snaking=!0,this._snakingTime=performance.now(),this._snakingVertices=this._snakingRings=this._snakingDistance=0,this._snakeLatLngs||(this._snakeLatLngs=o().LineUtil.isFlat(this._latlngs)?[this._latlngs]:this._latlngs),this._latlngs=[[this._snakeLatLngs[0][0],this._snakeLatLngs[0][0]]],this._update(),this._snake(),this.fire("snakestart"),this},_snake:function(){const t=performance.now(),e=t-this._snakingTime,n=e*this.options.snakingSpeed/1e3;return this._snakingTime=t,this._latlngs[this._snakingRings].pop(),this._snakeForward(n)},_snakeForward:function(t){if(!this._map)return;const e=this._map.latLngToContainerPoint(this._snakeLatLngs[this._snakingRings][this._snakingVertices]),n=this._map.latLngToContainerPoint(this._snakeLatLngs[this._snakingRings][this._snakingVertices+1]),i=e.distanceTo(n);if(this._snakingDistance+t>i){if(this._snakingVertices++,this._latlngs[this._snakingRings].push(this._snakeLatLngs[this._snakingRings][this._snakingVertices]),this._snakingVertices>=this._snakeLatLngs[this._snakingRings].length-1){if(this._snakingRings>=this._snakeLatLngs.length-1)return this._snakeEnd();this._snakingVertices=0,this._snakingRings++,this._latlngs[this._snakingRings]=[this._snakeLatLngs[this._snakingRings][this._snakingVertices]]}return this._snakingDistance-=i,this._snakeForward(t)}this._snakingDistance+=t;const s=this._snakingDistance/i,a=n.multiplyBy(s).add(e.multiplyBy(1-s)),r=this._map.containerPointToLatLng(a);this._latlngs[this._snakingRings].push(r),this.setLatLngs(this._latlngs),this.fire("snake"),o().Util.requestAnimFrame(this._snake,this)},_snakeEnd:function(){this.setLatLngs(this._snakeLatLngs),this._snaking=!1,this.fire("snakeend")}}),o().Polyline.mergeOptions({snakingSpeed:200}),o().LayerGroup.include({_snakingLayers:[],_snakingLayersDone:0,snakeIn:function(){if(!("performance"in window)||!("now"in window.performance)||!this._map||this._snaking)return;this._snaking=!0,this._snakingLayers=[],this._snakingLayersDone=0;const t=Object.keys(this._layers);for(let e in t){const n=t[e];this._snakingLayers.push(this._layers[n])}return this.clearLayers(),this.fire("snakestart"),this._snakeNext()},_snakeNext:function(){if(this._snakingLayersDone>=this._snakingLayers.length)return this.fire("snakeend"),void(this._snaking=!1);const t=this._snakingLayers[this._snakingLayersDone];return this._snakingLayersDone++,this.addLayer(t),"snakeIn"in t?(t.once("snakeend",(function(){setTimeout(this._snakeNext.bind(this),this.options.snakingPause)}),this),t.snakeIn()):setTimeout(this._snakeNext.bind(this),this.options.snakingPause),this.fire("snake"),this}}),o().LayerGroup.mergeOptions({snakingPause:200});const l={id:"map"};var u={setup(t){let e,n;const i=()=>{e=o().map("map",{center:[39.99,116.303],layers:[],zoom:15})},a=t=>{o().control.scale({maxWidth:100,metric:!0,imperial:!1}).addTo(t)},r=t=>{let e="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png";o().tileLayer(e,{minZoom:7,maxZoom:19}).addTo(t)},u=t=>{let n=window.URL.createObjectURL(t);new(o().GPX)(n,{async:!0}).on("loaded",(function(t){e.fitBounds(t.target.getBounds())}))},g=(0,s.FN)().appContext.config.globalProperties;return g.$bus.$on("fileRead",u),g.$bus.$on("sendPolyline",(t=>{let n=o().polyline(t,{snakingSpeed:200});n.addTo(e).snakeIn()})),(0,s.bv)((()=>{i(),a(e),r(e),n=o().layerGroup(),n.addTo(e)})),(t,e)=>((0,s.wg)(),(0,s.iD)("div",l))}};const g=u;var c=g,h=n(6462),d=n(235);const p=(0,s.Uk)("上传文件");var f={setup(t){let e=(0,a.iH)(null),n=1;const i=(0,s.FN)().appContext.config.globalProperties,r=({file:t})=>(i.$bus.$emit("fileRead",t.file),!1);return(t,i)=>((0,s.wg)(),(0,s.j4)((0,a.SU)(h.Z),{ref_key:"uploader",ref:e,accept:".gpx",max:(0,a.SU)(n),onBeforeUpload:r},{default:(0,s.w5)((()=>[(0,s.Wm)((0,a.SU)(d.Z),{type:"primary",size:"large"},{default:(0,s.w5)((()=>[p])),_:1})])),_:1},8,["max"]))}};const k=f;var m=k,_=n(1260),y=n(9468),v=n(3667),b=n(2568);const w=(0,s.Uk)("其他功能"),L=(0,s._)("span",null," 别看了，还没做呢 ",-1),x=(0,s._)("div",{id:"gd"},null,-1);var P={setup(t){const e=(0,_.U)(),n=(0,s.FN)().appContext.config.globalProperties,i=()=>{e.success("别点了，真的还没做呢"),n.$bus.$emit("titleRead",{title:{text:"Success",left:"center"}})};return(t,e)=>((0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)((0,a.SU)(y.Z),{vertical:""},{default:(0,s.w5)((()=>[(0,s.Wm)((0,a.SU)(v.ZP),{id:"title",bordered:!1,title:"GPXbox","header-style":"font-size:2.5em"}),(0,s.Wm)((0,a.SU)(y.Z),{justify:"space-around"},{default:(0,s.w5)((()=>[(0,s.Wm)((0,a.SU)(m)),(0,s.Wm)((0,a.SU)(b.Z),{trigger:"hover"},{trigger:(0,s.w5)((()=>[(0,s.Wm)((0,a.SU)(d.Z),{type:"primary",onClick:i,size:"large"},{default:(0,s.w5)((()=>[w])),_:1})])),default:(0,s.w5)((()=>[L])),_:1})])),_:1}),x])),_:1})]))}};const A=P;var S=A,$=n(3215),R=n(8720),U=n(7031),D=n(6069),T=n(9483),N=n(7309),O=n(542),j=n(2015),Z=n(5977),F=n(7103),C=n(5381),M=n(7049),W=n(1068),V=n.n(W);function z(t){let e=t.length,n=0;for(let i=0;i<e;i++)n+=t[i];return n/e}function G(t,e=0){let n=Math.pow(10,e);return Math.round(t*n)/n}function I(t){const e=new Date(t);let n=e.getFullYear(),i=e.getMonth()+1,s=e.getDate(),a=e.getHours(),r=e.getMinutes(),o=e.getSeconds();return i=i>9?i:"0"+i,s=s>9?s:"0"+s,a=a>9?a:"0"+a,r=r>9?r:"0"+r,o=o>9?o:"0"+o,`${n}-${i}-${s} ${a}:${r}:${o}`}function B(t){let e=new(V());e.parse(t);let n,i,s=e.tracks[0],a=s.distance.cumul,r=s.points,o=r.map((t=>t.time)),l=a.length,u=new Array(l);for(let g=0;g<l-2;g++)n=a[g+2]-a[g],i=o[g+2]-o[g],u[g+1]=1e3*n/i;u[0]=1e3*a[0]/(r[1].time-r[0].time),u[l-1]=1e3*(a[l-1]-a[l-2])/(r[l-1].time-r[l-2].time),this.timeArr=o,this.speedArr=u,this.gpx=e}B.prototype.getData=function(){let t=this.timeArr,e=this.speedArr,n=t.length,i=new Array(n);for(let s=0;s<n;s++)i[s]={value:[+t[s],e[s]]};return i},B.prototype.getDataAsKmPreHour=function(){let t=this.timeArr,e=this.speedArr,n=t.length,i=new Array(n);for(let s=0;s<n;s++)i[s]={value:[+t[s],3.6*e[s]]};return i},B.prototype.getDataAsMinutePerKm=function(){let t,e=Array.from(this.timeArr),n=Array.from(this.speedArr),i=e.length,s=new Array(i),a=e[e.length-1]-e[0],r=this.gpx.tracks[0].distance.total,o=a/(60*r);for(let l=0;l<i;l++){if(n[l]<.2){let e;e=l>1&&l<i-2?n.slice(l-2,l+2):1===l||l===i-2?n.slice(l-1,l+1):n,t=50/(3*z(e))}else t=50/(3*n[l]);t>3*o&&(t=0),s[l]={value:[+e[l],t]}}return s},B.prototype.toPolyline=function(){let t,e=this.gpx.tracks[0].points,n=e.length,i=new Array(n);for(let s=0;s<n;s++)t=e[s],i[s]=[t.lat,t.lon];return i};var H=B,E={setup(t){(0,s.JJ)($.bw,"light"),R.D([U.N,D.N,T.N,N.N,O.N,j.N,Z.N,F.N,M.N,C.z]);let e=2,n=105,i=Array(n),r=new Date(2022,5,16,5,30,30);for(let s=0;s<n;s++)r=new Date(r.valueOf()+1e3),i[s]={value:[+r,G(20*Math.random()+100,2)]};let o={title:{text:"GPXbox",left:"middle"},tooltip:{trigger:"axis",formatter:t=>{t=t[0].data;let e=I(t.value[0]);return`<p>${e}<br/>${G(t.value[1],2)}</p>`},axisPointer:{type:"cross",animation:!0,snap:!0}},xAxis:{type:"time",splitLine:{show:!1},boundaryGap:!1},yAxis:{type:"value",scale:!0,boundaryGap:["0%","0%"],splitNumber:2},toolbox:{show:!0,feature:{saveAsImage:{}}},dataZoom:[{type:"slider",xAxisIndex:0,filterMode:"filter"},{type:"slider",yAxisIndex:0,filterMode:"none",left:"92%"}],series:[{type:"line",smooth:!0,showSymbol:!1,data:i,markLine:{symbol:"none",data:[{symbol:"circle",label:{position:"end",backgroundColor:"rgba(143,243,192,0.5)",borderRadius:[4,4,4,4],padding:[5,5,5,5],formatter:t=>I(t.data.value)},xAxis:0},{symbol:"circle",yAxis:0,label:{position:"start",backgroundColor:"rgba(143,243,192,0.75)",borderRadius:[4,4,4,4],padding:[5,5,5,5]}}]},markPoint:{data:[],symbol:"circle",label:{show:!1},symbolSize:6,itemStyle:{color:"rgba(255, 0, 0, 1)"}}}]},l=(0,a.iH)(o);const u=(0,s.FN)().appContext.config.globalProperties;let g=[];function c(t){const n=new FileReader;n.readAsText(t,"utf-8"),n.onload=function(){for(let e=0,n=g.length;e<n;e++)clearTimeout(g[e]);l.value.series[0].data={};let t=new H(n.result);u.$bus.$emit("sendPolyline",t.toPolyline());let i,s=t.getData();l.value.series[0].data=s;let a=s.length,r=0,o=()=>{r<a-1&&(l.value.series[0].markLine.data[0].xAxis=s[r].value[0],l.value.series[0].markLine.data[1].yAxis=s[r].value[1],l.value.series[0].markPoint.data[0]={coord:[s[r].value[0],s[r].value[1]]}),i=setTimeout(o,(s[r+1].value[0]-s[r].value[0])/e),r+=1,g.push(i)};g.push(setTimeout(o,1e3/e))}}return u.$bus.$on("fileRead",c),u.$bus.$on("titleRead",(t=>{l.value=t})),(0,s.bv)((()=>{})),(t,e)=>((0,s.wg)(),(0,s.j4)((0,a.SU)($.ZP),{class:"chart",option:(0,a.SU)(l),autoresize:!0},null,8,["option"]))}};const X=E;var J=X,K=n(8283);const q={id:"container-up-down"},Y={id:"container-left-right"};var Q={setup(t){return(t,e)=>((0,s.wg)(),(0,s.j4)((0,a.SU)(K.Z),null,{default:(0,s.w5)((()=>[(0,s._)("div",q,[(0,s._)("div",Y,[(0,s.Wm)((0,a.SU)(c),{id:"map"}),(0,s.Wm)((0,a.SU)(S),{id:"panel",ref:"panel"},null,512)]),(0,s.Wm)((0,a.SU)(J),{id:"map-charts"})])])),_:1}))}};const tt=Q;var et=tt,nt=n(1373);const it=(0,nt.Z)(),st={};st.$on=it.on,st.$off=it.off,st.$emit=it.emit;var at=st;const rt=(0,i.ri)(et);rt.config.globalProperties.$bus=at,rt.mount("#app")}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var a=e[i]={exports:{}};return t[i].call(a.exports,a,a.exports,n),a.exports}n.m=t,function(){var t=[];n.O=function(e,i,s,a){if(!i){var r=1/0;for(g=0;g<t.length;g++){i=t[g][0],s=t[g][1],a=t[g][2];for(var o=!0,l=0;l<i.length;l++)(!1&a||r>=a)&&Object.keys(n.O).every((function(t){return n.O[t](i[l])}))?i.splice(l--,1):(o=!1,a<r&&(r=a));if(o){t.splice(g--,1);var u=s();void 0!==u&&(e=u)}}return e}a=a||0;for(var g=t.length;g>0&&t[g-1][2]>a;g--)t[g]=t[g-1];t[g]=[i,s,a]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,i){var s,a,r=i[0],o=i[1],l=i[2],u=0;if(r.some((function(e){return 0!==t[e]}))){for(s in o)n.o(o,s)&&(n.m[s]=o[s]);if(l)var g=l(n)}for(e&&e(i);u<r.length;u++)a=r[u],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return n.O(g)},i=self["webpackChunkgpxbox"]=self["webpackChunkgpxbox"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(2566)}));i=n.O(i)})();
//# sourceMappingURL=app.62371170.js.map