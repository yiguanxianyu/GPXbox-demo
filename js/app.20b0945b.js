(function(){"use strict";var e={9779:function(e,t,n){var o=n(9242),r=n(3396),a=n(4870),l=n(3153),i=n.n(l);n(8847);const s={id:"map"};var u={setup(e){let t,n,o,a,l,u,p,c,d=1,f=[];const m=()=>{t=i().map("map",{center:[39.99,116.303],zoom:15,preferCanvas:!0})},g=e=>{i().control.scale({maxWidth:100,metric:!0,imperial:!1}).addTo(e)},b=e=>{let t="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png";i().tileLayer(t,{minZoom:7,maxZoom:19}).addTo(e)},y=()=>{},v=(0,r.FN)().appContext.config.globalProperties;return v.$bus.$on("fileRead",y),v.$bus.$on("speedRatioChanged",(e=>{d=e})),v.$bus.$on("sendPolyline",(e=>{n.setLatLngs(e.polyline),o.setPaths(e.polyline),t.fitBounds(n.getBounds()),void 0===l?l=i().polyline([{lat:e.polyline[0][0],lon:e.polyline[0][1]}],{weight:4,color:"#11eeb2"}).addTo(t):l.setLatLngs([{lat:e.polyline[0][0],lon:e.polyline[0][1]}]),a=0,u=e.polyline.length,c=e.timeDelta;let r=new Array(u);for(let t=0;t<u;t++){let n=e.polyline[t];r[t]={lat:n[0],lon:n[1]}}p=r})),v.$bus.$on("play",(()=>{let e=()=>{a<u-1&&(l.addLatLng(p[a]),f.push(setTimeout(e,c[a]/d)),a++)};f.push(setTimeout(e,0))})),v.$bus.$on("pause",(()=>{for(let e=0,t=f.length;e<t;e++)clearTimeout(f[e])})),v.$bus.$on("backToStart",(()=>{a=0;let e=l.getLatLngs()[0];l.setLatLngs([e])})),(0,r.bv)((()=>{m(),g(t),b(t),n=i().polyline([],{smoothFactor:.5,weight:3}).addTo(t),o=i().polylineDecorator([],{patterns:[{repeat:50,symbol:i().Symbol.arrowHead({pixelSize:4,headAngle:75,polygon:!1,pathOptions:{stroke:!0,weight:1,color:"#d20b0b"}})}]}).addTo(t)})),(e,t)=>((0,r.wg)(),(0,r.iD)("div",s))}};const p=u;var c=p,d=n(7238),f=n(235);const m=(0,r.Uk)("打开 GPX 文件");var g={setup(e){let t=(0,a.iH)(null);const n=(0,r.FN)().appContext.config.globalProperties,o=({file:e})=>(n.$bus.$emit("fileRead",e.file),n.$bus.$emit("fileTitleRead",e.file.name),!1);return(e,n)=>((0,r.wg)(),(0,r.j4)((0,a.SU)(d.Z),{ref_key:"uploader",ref:t,max:1,accept:".gpx",onBeforeUpload:o},{default:(0,r.w5)((()=>[(0,r.Wm)((0,a.SU)(f.Z),{size:"large",type:"primary"},{default:(0,r.w5)((()=>[m])),_:1})])),_:1},512))}};const b=g;var y=b,v=n(4786),h=n(1260),$=n(9468),w=n(3667),x=n(3645),k=n(8491),S=n(3144),A=n(4722),U=n(1176),P=n(2505),T=n(4299),Z=n(4470);const L=(0,r.Uk)("  播放 "),_=(0,r.Uk)("  暂停 "),W=(0,r.Uk)("  回到起点 "),C=(0,r.Uk)(" 倍速 "),O=(0,r.Uk)(" 允许设置的倍速范围为 0.1 ~ 10 "),D=(0,r.Uk)("用户资料");var N={setup(e){const t=e=>()=>(0,r.h)(v.g,null,{default:()=>(0,r.h)(e)}),n=(0,h.U)(),o=(0,r.FN)().appContext.config.globalProperties,l=t(A.Z),i=(0,a.iH)([{label:"m/s",key:0,icon:l},{label:"km/h",key:1},{label:"min/km",key:2}]);function s(e){for(let t=0;t<3;t++)i.value[t].icon=null;i.value[e].icon=l,o.$bus.$emit("unitOfSpeedChanged",e)}const u=(0,a.iH)();function p(e){null!==e&&(o.$bus.$emit("speedRatioChanged",e),n.info("调整为"+e+"倍速"),u.value=e)}function c(){o.$bus.$emit("play")}function d(){o.$bus.$emit("pause")}function m(){o.$bus.$emit("backToStart")}return(e,t)=>((0,r.wg)(),(0,r.j4)((0,a.SU)($.Z),{vertical:""},{default:(0,r.w5)((()=>[(0,r.Wm)((0,a.SU)(w.ZP),{id:"title",bordered:!1,"header-style":"font-size:2.5em",title:"GPXbox"}),(0,r.Wm)((0,a.SU)(y)),(0,r.Wm)((0,a.SU)($.Z),{justify:"space-around"},{default:(0,r.w5)((()=>[(0,r.Wm)((0,a.SU)(f.Z),{secondary:"",strong:"",onClick:c},{default:(0,r.w5)((()=>[(0,r.Wm)((0,a.SU)(v.g),{component:(0,a.SU)(U.Z)},null,8,["component"]),L])),_:1}),(0,r.Wm)((0,a.SU)(f.Z),{secondary:"",strong:"",onClick:d},{default:(0,r.w5)((()=>[(0,r.Wm)((0,a.SU)(v.g),{component:(0,a.SU)(P.Z)},null,8,["component"]),_])),_:1}),(0,r.Wm)((0,a.SU)(f.Z),{secondary:"",strong:"",onClick:m},{default:(0,r.w5)((()=>[(0,r.Wm)((0,a.SU)(v.g),{component:(0,a.SU)(T.Z)},null,8,["component"]),W])),_:1})])),_:1}),(0,r.Wm)((0,a.SU)(x.Z),{trigger:"hover"},{trigger:(0,r.w5)((()=>[(0,r.Wm)((0,a.SU)(k.Z),{id:"inputNumber","default-value":1,max:10,min:.1,value:u.value,"onUpdate:value":p},{suffix:(0,r.w5)((()=>[C])),prefix:(0,r.w5)((()=>[(0,r.Wm)((0,a.SU)(v.g),{component:(0,a.SU)(Z.Z),depth:1},null,8,["component"])])),_:1},8,["min","value"])])),default:(0,r.w5)((()=>[O])),_:1}),(0,r.Wm)((0,a.SU)(S.Z),{options:i.value,trigger:"hover",onSelect:s},{default:(0,r.w5)((()=>[(0,r.Wm)((0,a.SU)(f.Z),null,{default:(0,r.w5)((()=>[D])),_:1})])),_:1},8,["options"])])),_:1}))}};const M=N;var j=M,R=n(3215),H=n(8720),z=n(5977),F=n(7031),G=n(6069),K=n(9483),B=n(7309),I=n(542),X=n(2015),J=n(7103),E=n(5381),Y=n(7049),q=n(1068),Q=n.n(q);function V(e){let t=e.length;if(void 0===t)return e;{let n=0;for(let o=0;o<t;o++)n+=e[o];return n/t}}function ee(e,t=0){let n=Math.pow(10,t);return Math.round(e*n)/n}function te(e){const t=new Date(e);let n=t.getFullYear(),o=t.getMonth()+1,r=t.getDate(),a=t.getHours(),l=t.getMinutes(),i=t.getSeconds();return o=o>9?o:"0"+o,r=r>9?r:"0"+r,a=a>9?a:"0"+a,l=l>9?l:"0"+l,i=i>9?i:"0"+i,`${n}-${o}-${r} ${a}:${l}:${i}`}function ne(e){let t=new(Q());t.parse(e);let n,o,r=t.tracks[0],a=r.distance.cumul,l=r.points,i=l.map((e=>+e.time)),s=a.length,u=new Array(s);for(let p=0;p<s-2;p++)n=a[p+2]-a[p],o=i[p+2]-i[p],u[p+1]=1e3*n/o;u[0]=1e3*a[0]/(l[1].time-l[0].time),u[s-1]=1e3*(a[s-1]-a[s-3])/(l[s-1].time-l[s-3].time),this.timeArr=i,this.speedArr=u,this.gpx=t}ne.prototype.getData=function(){let e=this.timeArr,t=this.speedArr,n=e.length,o=new Array(n);for(let r=0;r<n;r++)o[r]={value:[e[r],t[r]]};return o},ne.prototype.getDataAsKmPreHour=function(){let e=this.timeArr,t=this.speedArr,n=e.length,o=new Array(n);for(let r=0;r<n;r++)o[r]={value:[e[r],3.6*t[r]]};return o},ne.prototype.getDataAsMinutePerKm=function(){let e,t,n=Array.from(this.timeArr),o=Array.from(this.speedArr),r=n.length,a=new Array(r),l=n[n.length-1]-n[0],i=this.gpx.tracks[0].distance.total,s=l/(60*i);for(let u=0;u<r;u++)o[u]<.2?(e=u>1&&u<r-2?o.slice(u-2,u+2):1===u||u===r-2?o.slice(u-1,u+1):o,t=50/(3*V(e))):t=50/(3*o[u]),t>3*s&&(t=0),a[u]={value:[n[u],t]};return a},ne.prototype.toPolyline=function(){let e,t=this.gpx.tracks[0].points,n=t.length,o=new Array(n);for(let r=0;r<n;r++)e=t[r],o[r]=[e.lat,e.lon];return o},ne.prototype.getTimeArr=function(){return this.timeArr};var oe=ne,re={setup(e){function t(e){console.log(e)}(0,r.JJ)(R.bw,"light"),H.D([z.N,F.N,G.N,K.N,B.N,I.N,X.N,J.N,Y.N,E.z]);let n,o,l,i,s=1,u=new Date(2022,5,16,5,30,30),p=105,c=Array(p);for(let r=0;r<p;r++)u=new Date(u.valueOf()+1e3),c[r]={value:[+u,ee(20*Math.random()+100,2)]};let d={title:{text:"GPXbox",left:"center"},tooltip:{trigger:"axis",formatter:e=>{e=e[0].data;let t=te(e.value[0]);return`<p>${t}<br/>${ee(e.value[1],2)}</p>`},axisPointer:{type:"cross",animation:!0,snap:!0}},xAxis:{type:"time",splitLine:{show:!1},boundaryGap:!1},yAxis:{type:"value",scale:!0,boundaryGap:["0%","0%"],splitNumber:2},toolbox:{show:!0,feature:{saveAsImage:{}}},dataZoom:[{type:"slider",xAxisIndex:0,filterMode:"filter"},{type:"slider",yAxisIndex:0,filterMode:"none",left:"92%"}],series:[{type:"line",smooth:!0,showSymbol:!1,data:c,markLine:{symbol:"none",data:[{symbol:"circle",label:{position:"end",backgroundColor:"rgba(143,243,192,0.5)",borderRadius:[4,4,4,4],padding:[5,5,5,5],formatter:e=>te(e.data.value)},xAxis:0},{symbol:"circle",yAxis:0,label:{position:"start",backgroundColor:"rgba(143,243,192,0.75)",borderRadius:[4,4,4,4],padding:[5,5,5,5]}}]},markPoint:{data:[],symbol:"circle",label:{show:!1},symbolSize:6,itemStyle:{color:"rgba(255, 0, 0, 1)"}}}]},f=(0,a.iH)(d);const m=(0,a.iH)();(0,r.bv)((()=>{}));const g=(0,r.FN)().appContext.config.globalProperties;let b=[];function y(e){const t=new FileReader;t.readAsText(e,"utf-8"),t.onload=()=>{for(let t=0,n=b.length;t<n;t++)clearTimeout(b[t]);n=new oe(t.result),o=0,l=n.getData(),f.value.series[0].data=l;let e=n.getTimeArr();p=l.length,i=new Array(p);for(let t=0;t<p;t++)i[t]=e[t+1]-e[t];i[p-1]=0,g.$bus.$emit("sendPolyline",{polyline:n.toPolyline(),timeDelta:i})}}return g.$bus.$on("fileRead",y),g.$bus.$on("fileTitleRead",(e=>{f.value.title.text=e})),g.$bus.$on("speedRatioChanged",(e=>{s=e})),g.$bus.$on("play",(()=>{let e=()=>{o<p-1&&(f.value.series[0].markLine.data[0].xAxis=l[o].value[0],f.value.series[0].markLine.data[1].yAxis=l[o].value[1],f.value.series[0].markPoint.data[0]={coord:l[o].value},b.push(setTimeout(e,i[o]/s)),o++)};b.push(setTimeout(e,0))})),g.$bus.$on("pause",(()=>{for(let e=0,t=b.length;e<t;e++)clearTimeout(b[e])})),g.$bus.$on("backToStart",(()=>{o=0,f.value.series[0].markLine.data[0].xAxis=l[0].value[0],f.value.series[0].markLine.data[1].yAxis=l[0].value[1],f.value.series[0].markPoint.data[0]={coord:l[0].value}})),g.$bus.$on("unitOfSpeedChanged",(e=>{0===e?(l=n.getData(),f.value.series[0].markLine.data[1].label.formatter="{c} m/s"):1===e?(l=n.getDataAsKmPreHour(),f.value.series[0].markLine.data[1].label.formatter="{c} km/h"):2===e?(l=n.getDataAsMinutePerKm(),f.value.series[0].markLine.data[1].label.formatter=e=>{let t=Math.trunc(e.data.value),n=Math.trunc(60*(e.data.value-t));return n<10&&(n="0"+n),t+":"+n}):console.log(e),f.value.series[0].data=l})),(e,n)=>((0,r.wg)(),(0,r.j4)((0,a.SU)(R.ZP),{ref_key:"chart",ref:m,autoresize:!0,option:(0,a.SU)(f),onClick:t},null,8,["option"]))}};const ae=re;var le=ae,ie=n(3838);const se={id:"container-up-down"},ue={id:"container-left-right"};var pe={setup(e){return(e,t)=>((0,r.wg)(),(0,r.j4)((0,a.SU)(ie.Z),null,{default:(0,r.w5)((()=>[(0,r._)("div",se,[(0,r._)("div",ue,[(0,r.Wm)((0,a.SU)(c),{id:"map"}),(0,r.Wm)((0,a.SU)(j),{id:"panel",ref:"panel"},null,512)]),(0,r.Wm)((0,a.SU)(le),{id:"map-charts"})])])),_:1}))}};const ce=pe;var de=ce,fe=n(1373);const me=(0,fe.Z)(),ge={};ge.$on=me.on,ge.$off=me.off,ge.$emit=me.emit;var be=ge;const ye=(0,o.ri)(de);ye.config.globalProperties.$bus=be,ye.mount("#app")}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,a){if(!o){var l=1/0;for(p=0;p<e.length;p++){o=e[p][0],r=e[p][1],a=e[p][2];for(var i=!0,s=0;s<o.length;s++)(!1&a||l>=a)&&Object.keys(n.O).every((function(e){return n.O[e](o[s])}))?o.splice(s--,1):(i=!1,a<l&&(l=a));if(i){e.splice(p--,1);var u=r();void 0!==u&&(t=u)}}return t}a=a||0;for(var p=e.length;p>0&&e[p-1][2]>a;p--)e[p]=e[p-1];e[p]=[o,r,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,a,l=o[0],i=o[1],s=o[2],u=0;if(l.some((function(t){return 0!==e[t]}))){for(r in i)n.o(i,r)&&(n.m[r]=i[r]);if(s)var p=s(n)}for(t&&t(o);u<l.length;u++)a=l[u],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(p)},o=self["webpackChunkgpxbox"]=self["webpackChunkgpxbox"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(9779)}));o=n.O(o)})();
//# sourceMappingURL=app.20b0945b.js.map