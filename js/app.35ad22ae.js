(function(){"use strict";var t={2661:function(t,e,a){var n=a(9242),o=a(3396),l=a(4870),i=a(3153),r=a.n(i);a(8847);const s=(0,o._)("div",{id:"map"},null,-1),u=[s];var d={setup(t){let e,a,n,l,i;const s=(0,o.FN)().appContext.config.globalProperties.$bus;s.$on("sendPolyline",(t=>{a.setLatLngs(t),n.setPaths(a.getLatLngs()),e.fitBounds(a.getBounds()),void 0===l?l=r().polyline([t[0]],{weight:4,color:"#ff6500"}).addTo(e):l.setLatLngs([t[0]]),i=t})),s.$on("backToStart",(()=>{let t=l.getLatLngs()[0];l.setLatLngs([t])})),s.$on("indexChanged",(t=>{l.setLatLngs(i.slice(0,t))})),s.$on("sliderValueChanged",(t=>{l.setLatLngs(i.slice(0,t))}));const d=()=>{e=r().map("map",{center:[39.99,116.303],zoom:15,attributionControl:!1})},c=t=>{r().control.scale({maxWidth:100,metric:!0,imperial:!1}).addTo(t)},m=t=>{let e="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png";r().tileLayer(e,{minZoom:7,maxZoom:19}).addTo(t)};return(0,o.bv)((()=>{d(),c(e),m(e),a=r().polyline([],{weight:4,color:"#00ad53"}).addTo(e),n=r().polylineDecorator([],{patterns:[{repeat:50,symbol:r().Symbol.arrowHead({pixelSize:5,headAngle:75,polygon:!1,pathOptions:{stroke:!0,weight:2,color:"#0f2fe0"}})}]}).addTo(e)})),(t,e)=>((0,o.wg)(),(0,o.iD)("div",null,u))}};const c=d;var m=c,p=a(7139),f=a(5608),g=a(9700),h=a(1176),v=a(2505),b=a(9163),U=a(4299),y=a(7541),S=a(4470),w=a(5672),x=a(4567),k=a(9398),_=a(301),P=a(4786),A=a(1260),Z=a(6296),$=a(7238),W=a(235),L=a(3144),D=a(3645),C=a(8491),T=a(7119),H=a(5210),M=a(8870);function O(t){t/=1e3;const e=parseInt(t/3600),a=parseInt(t/60%60),n=Math.ceil(t%60),o=e<10?"0"+e:e,l=n>59?59:n;return`${o>0?`${o}:`:""}${a<10?"0"+a:a}:${l<10?"0"+l:l}`}function F(t){return t>=1e4?(.001*t).toFixed(2)+"km":t.toFixed(1)+"m"}const z={id:"box"},N=(0,o.Uk)(" 一个还算不错的 GPX 可视化工具 "),K={class:"row"},j=(0,o.Uk)(" 打开 GPX "),R=(0,o.Uk)("  播放 "),G=(0,o.Uk)("  暂停 "),I={class:"row"},Y=(0,o.Uk)("  倒放 "),X=(0,o.Uk)("  回到起点 "),B=(0,o.Uk)("  速度单位 "),V=(0,o.Uk)(" 倍速 "),E=(0,o.Uk)(" 允许设置的倍速范围为 0.1 ~ 8 "),q=(0,o.Uk)("总里程"),J=(0,o.Uk)("总时间"),Q=(0,o.Uk)("平均速度"),tt=(0,o.Uk)("记录点数量"),et=(0,o.Uk)("已移动时间"),at=(0,o.Uk)("已移动距离");var nt={setup(t){const e=t=>()=>(0,o.h)(P.g,null,{default:()=>(0,o.h)(t)});let a,n,i,r,s=(0,l.iH)(!0);const u=(0,l.iH)(),d=(0,l.iH)(0),c=(0,l.iH)(0),m=(0,l.iH)(0),nt=(0,l.iH)(),ot=(0,l.iH)(),lt=(0,l.iH)(),it=(0,l.iH)(),rt=e(f.Z),st=(0,A.U)(),ut=(0,o.FN)().appContext.config.globalProperties.$bus;let dt=0;const ct=(0,l.iH)([{label:"m/s",key:0,icon:rt},{label:"km/h",key:1},{label:"min/km (Experimental)",key:2}]),mt=t=>{m.value=F(n[t]),c.value=O(i[t]-r)};function pt(t){const e=(1e-4*t*it.value).toFixed();mt(e),ut.$emit("sliderValueChanged",e)}function ft(t){if(s.value)st.warning("请先读取文件");else{ut.$emit("unitOfSpeedChanged",t),lt.value=a[t];for(let t=0;t<3;t++)ct.value[t].icon=null;ct.value[t].icon=rt}}function gt(t){null===t?st.error("请输入正确的倍速"):(ut.$emit("speedRatioChanged",t),u.value=t,st.success("调整为"+t+"倍速"))}function ht(){ut.$emit("play")}function vt(){ut.$emit("pause")}function bt(){ut.$emit("playReversed")}function Ut(){ut.$emit("backToStart"),mt(0),d.value=0}function yt({file:t}){return ut.$emit("fileRead",t.file),!1}return ut.$on("statsData",(t=>{nt.value=F(t.totalDistance),ot.value=t.totalTime,it.value=t.numPoints,a=t.meanSpeed,lt.value=a[dt],i=t.timeArr,r=i[0],n=t.cumulDist})),ut.$on("fileRead",(()=>{s.value=!1})),ut.$on("indexChanged",(t=>{d.value=1e4*t/it.value,mt(t)})),(t,e)=>((0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",z,[(0,o.Wm)((0,l.SU)(Z.ZP),{id:"title",bordered:"",embedded:"","header-style":"font-size:2.5em",size:"small",title:"GPXbox"},{default:(0,o.w5)((()=>[N])),_:1}),(0,o._)("div",K,[(0,o._)("div",null,[(0,o.Wm)((0,l.SU)($.Z),{max:1,accept:".gpx",onBeforeUpload:yt},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(W.Z),{color:"#149D1F",secondary:"",strong:""},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(P.g),{component:(0,l.SU)(g.Z)},null,8,["component"]),j])),_:1})])),_:1})]),(0,o.Wm)((0,l.SU)(W.Z),{disabled:(0,l.SU)(s),secondary:"",strong:"",onClick:ht},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(P.g),{component:(0,l.SU)(h.Z)},null,8,["component"]),R])),_:1},8,["disabled"]),(0,o.Wm)((0,l.SU)(W.Z),{disabled:(0,l.SU)(s),secondary:"",strong:"",onClick:vt},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(P.g),{component:(0,l.SU)(v.Z)},null,8,["component"]),G])),_:1},8,["disabled"])]),(0,o._)("div",I,[(0,o.Wm)((0,l.SU)(W.Z),{disabled:(0,l.SU)(s),secondary:"",strong:"",onClick:bt},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(P.g),{component:(0,l.SU)(b.Z)},null,8,["component"]),Y])),_:1},8,["disabled"]),(0,o.Wm)((0,l.SU)(W.Z),{disabled:(0,l.SU)(s),secondary:"",strong:"",onClick:Ut},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(P.g),{component:(0,l.SU)(U.Z)},null,8,["component"]),X])),_:1},8,["disabled"]),(0,o.Wm)((0,l.SU)(L.Z),{options:ct.value,trigger:"hover",onSelect:ft},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(W.Z),{secondary:"",strong:""},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(P.g),{component:(0,l.SU)(y.Z)},null,8,["component"]),B])),_:1})])),_:1},8,["options"])]),(0,o.Wm)((0,l.SU)(D.Z),{trigger:"hover"},{trigger:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(C.Z),{id:"inputNumber","default-value":1,max:8,min:.1,value:u.value,"onUpdate:value":gt},{prefix:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(P.g),{component:(0,l.SU)(S.Z),depth:1},null,8,["component"])])),suffix:(0,o.w5)((()=>[V])),_:1},8,["min","value"])])),default:(0,o.w5)((()=>[E])),_:1}),(0,o.Wm)((0,l.SU)(T.Z),{cols:2,"y-gap":"6"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(H.ZP),{class:"statsLabel"},{default:(0,o.w5)((()=>[q])),_:1}),(0,o.Wm)((0,l.SU)(H.ZP),{class:"statsLabel"},{default:(0,o.w5)((()=>[J])),_:1}),(0,o.Wm)((0,l.SU)(H.ZP),{class:"statsData"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(P.g),{component:(0,l.SU)(w.Z)},null,8,["component"]),(0,o.Uk)(" "+(0,p.zw)(nt.value),1)])),_:1}),(0,o.Wm)((0,l.SU)(H.ZP),{class:"statsData"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(P.g),{component:(0,l.SU)(x.Z)},null,8,["component"]),(0,o.Uk)(" "+(0,p.zw)(ot.value),1)])),_:1}),(0,o.Wm)((0,l.SU)(H.ZP),{class:"statsLabel"},{default:(0,o.w5)((()=>[Q])),_:1}),(0,o.Wm)((0,l.SU)(H.ZP),{class:"statsLabel"},{default:(0,o.w5)((()=>[tt])),_:1}),(0,o.Wm)((0,l.SU)(H.ZP),{class:"statsData"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(P.g),{component:(0,l.SU)(k.Z)},null,8,["component"]),(0,o.Uk)(" "+(0,p.zw)(lt.value),1)])),_:1}),(0,o.Wm)((0,l.SU)(H.ZP),{class:"statsData"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,l.SU)(P.g),{component:(0,l.SU)(_.Z)},null,8,["component"]),(0,o.Uk)(" "+(0,p.zw)(it.value),1)])),_:1}),(0,o.Wm)((0,l.SU)(H.ZP),{class:"statsLabel"},{default:(0,o.w5)((()=>[et])),_:1}),(0,o.Wm)((0,l.SU)(H.ZP),{class:"statsLabel"},{default:(0,o.w5)((()=>[at])),_:1}),(0,o.Wm)((0,l.SU)(H.ZP),{class:"statsData"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,p.zw)(c.value),1)])),_:1}),(0,o.Wm)((0,l.SU)(H.ZP),{class:"statsData"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,p.zw)(m.value),1)])),_:1})])),_:1}),(0,o.Wm)((0,l.SU)(M.Z),{id:"slider",value:d.value,"onUpdate:value":[e[0]||(e[0]=t=>d.value=t),pt],disabled:(0,l.SU)(s),"format-tooltip":t=>`${(.01*t).toFixed(2)}%`,max:1e4,step:1,placement:"bottom","show-tooltip":""},null,8,["value","disabled","format-tooltip"])])]))}};const ot=nt;var lt=ot,it=a(3215),rt=a(8720),st=a(5977),ut=a(7031),dt=a(6069),ct=a(9483),mt=a(7309),pt=a(542),ft=a(2015),gt=a(7103),ht=a(5381),vt=a(7049),bt=a(1068),Ut=a.n(bt);function yt(t){let e=new(Ut());e.parse(t);let a=e.tracks[0],n=a.distance.cumul,o=a.points,l=o.map((t=>+t.time));const i=n.length;let r,s,u=new Array(i+10),d=new Array(i+10),c=new Array(i);for(let m=0;m<5;m++)u[m]=0,d[m]=l[0];for(let m=5;m<i+5;m++)u[m]=n[m-5],d[m]=l[m-5];for(let m=i+5;m<i+10;m++)u[m]=n[i-1],d[m]=l[i-1];for(let m=0;m<i;m++)r=u[m+10]-u[m],s=d[m+10]-d[m],c[m]=1e3*r/s;this.speedArr=c,this.gpx=e,this.dataLength=i,this._timeArr=l,this._data=null,this._dataAsKmPreHour=null,this._dataAsMinutePerKm=null,this._polyline=null,this._stats=null}yt.prototype.getData=function(){if(null===this._data){const t=this._timeArr,e=this.speedArr,a=this.dataLength;let n=new Array(a);for(let o=0;o<a;o++)n[o]={value:[t[o],e[o]]};this._data=n}return this._data},yt.prototype.getDataAsKmPreHour=function(){if(null===this._dataAsKmPreHour){const t=this._timeArr,e=this.speedArr,a=this.dataLength;let n=new Array(a);for(let o=0;o<a;o++)n[o]={value:[t[o],3.6*e[o]]};this._dataAsKmPreHour=n}return this._dataAsKmPreHour},yt.prototype.getDataAsMinutePerKm=function(){if(null===this._dataAsMinutePerKm){const t=this._timeArr,e=this.dataLength,a=new Array(e+10).fill(0);for(let s=5;s<e+5;s++)a[s]=this.speedArr[s];const n=t[t.length-1]-t[0],o=this.gpx.tracks[0].distance.total,l=n/(60*o);let i,r=new Array(e);for(let s=0;s<e;s++)i=50/(3*a[s]),i>3*l&&(i=0),r[s]={value:[t[s],i]};this._dataAsMinutePerKm=r}return this._dataAsMinutePerKm},yt.prototype.toPolyline=function(){if(null===this._polyline){const t=this.gpx.tracks[0].points,e=this.dataLength;let a,n=new Array(e);for(let o=0;o<e;o++)a=t[o],n[o]={lat:a.lat,lon:a.lon};this._polyline=n}return this._polyline},yt.prototype.getTimeArr=function(){return this._timeArr},yt.prototype.getStats=function(){if(null===this._stats){let t={};const e=this.dataLength,a=this.gpx.tracks[0].points[e-1].time-this.gpx.tracks[0].points[0].time;t.numPoints=e,t.totalTime=O(a),t.totalDistance=this.gpx.tracks[0].distance.total.toFixed();const n=1e3*t.totalDistance/a,o=3.6*n,l=1e3/n;t.meanSpeed=[n.toFixed(2)+"m/s",o.toFixed(2)+"km/h",O(1e3*l)+"/km"],t.cumulDist=this.gpx.tracks[0].distance.cumul,t.timeArr=this._timeArr,this._stats=t}return this._stats};var St=yt,wt={setup(t){(0,rt.D)([st.N,ut.N,dt.N,ct.N,mt.N,pt.N,ft.N,gt.N,vt.N,ht.z]);let e,a,n,i,r,s=1;const u=[{markLineY:"{c} m/s",tooltip:t=>`${t[0].data.value[1].toFixed(2)}m/s`},{markLineY:"{c} km/h",tooltip:t=>`${t[0].data.value[1].toFixed(2)}km/h`},{markLineY:t=>{let e=Math.trunc(t.data.value),a=Math.trunc(60*(t.data.value-e));return a<10&&(a="0"+a),e+":"+a},tooltip:t=>{let e=t[0].data.value[1],a=Math.trunc(e),n=Math.trunc(60*(e-a));return n<10&&(n="0"+n),a+":"+n+"/km"}}],d=(0,l.iH)({title:{text:"GPXbox",left:"center"},tooltip:{trigger:"axis",formatter:u[0].tooltip,axisPointer:{type:"cross",animation:!0,snap:!0}},xAxis:{type:"time",splitLine:{show:!1},boundaryGap:!1},yAxis:{type:"value",scale:!0,boundaryGap:["0%","0%"],splitNumber:2},toolbox:{show:!0,feature:{saveAsImage:{}}},dataZoom:[{type:"slider",xAxisIndex:0,filterMode:"filter"},{type:"slider",yAxisIndex:0,filterMode:"none",left:"92%"}],series:[{type:"line",smooth:!0,showSymbol:!1,markLine:{symbol:"none",data:[{symbol:"circle",label:{position:"end",backgroundColor:"rgba(143,243,192,0.5)",borderRadius:[4,4,4,4],padding:[5,5,5,5],formatter:t=>new Date(t.data.coord[0]).toLocaleString()},xAxis:0},{symbol:"circle",yAxis:0,label:{position:"start",backgroundColor:"rgba(143,243,192,0.75)",borderRadius:[4,4,4,4],padding:[5,5,5,5],formatter:u[0].markLineY}}]},markPoint:{data:[],symbol:"circle",label:{show:!1},symbolSize:6,itemStyle:{color:"rgba(255, 0, 0, 1)"}}}]}),c=(0,l.iH)(),m=(0,o.FN)().appContext.config.globalProperties.$bus;let p=[];const f=()=>{const t=p.length;for(let e=0;e<t;e++)clearTimeout(p[e]);p=[]},g=t=>{d.value.series[0].markLine.data[0].xAxis=n[t].value[0],d.value.series[0].markLine.data[1].yAxis=n[t].value[1],d.value.series[0].markPoint.data[0]={coord:n[t].value}},h=t=>{f();const e=t.dataIndex;m.$emit("indexChanged",e),g(e),a=e};return m.$on("fileRead",(t=>{f(),d.value.title.text=t.name;const o=new FileReader;o.readAsText(t,"utf-8"),o.onload=()=>{e=new St(o.result),a=0,n=e.getData(),d.value.series[0].data=n;const t=e.getTimeArr();r=n.length,i=new Array(r);for(let e=0;e<r;e++)i[e]=t[e+1]-t[e];i[r-1]=0,m.$emit("sendPolyline",e.toPolyline()),m.$emit("statsData",e.getStats())}})),m.$on("speedRatioChanged",(t=>{s=t})),m.$on("play",(()=>{f();const t=()=>{a++<r?(g(a),m.$emit("indexChanged",a),p.push(setTimeout(t,i[a]/s))):f()};p.push(setTimeout(t,i[a]/s))})),m.$on("playReversed",(()=>{f();const t=()=>{a--?(g(a),m.$emit("indexChanged",a),p.push(setTimeout(t,i[a]/s))):f()};p.push(setTimeout(t,i[a]/s))})),m.$on("pause",f),m.$on("backToStart",(()=>{a=0,g(0)})),m.$on("unitOfSpeedChanged",(t=>{0===t?n=e.getData():1===t?n=e.getDataAsKmPreHour():2===t?n=e.getDataAsMinutePerKm():console.log(t),d.value.series[0].markLine.data[1].label.formatter=u[t].markLineY,d.value.tooltip.formatter=u[t].tooltip,d.value.series[0].data=n,g(a)})),m.$on("sliderValueChanged",(t=>{f(),g(t)})),(t,e)=>((0,o.wg)(),(0,o.j4)((0,l.SU)(it.ZP),{ref_key:"chart",ref:c,autoresize:!0,option:d.value,onClick:h},null,8,["option"]))}};const xt=wt;var kt=xt,_t=a(3838);const Pt={id:"container-up-down"},At={id:"container-left-right"};var Zt={setup(t){return(t,e)=>((0,o.wg)(),(0,o.j4)((0,l.SU)(_t.Z),null,{default:(0,o.w5)((()=>[(0,o._)("div",Pt,[(0,o._)("div",At,[(0,o.Wm)((0,l.SU)(m),{id:"map"}),(0,o.Wm)((0,l.SU)(lt),{id:"panel"})]),(0,o.Wm)((0,l.SU)(kt),{id:"map-charts"})])])),_:1}))}};const $t=Zt;var Wt=$t,Lt=a(1373);const Dt=(0,Lt.Z)(),Ct={};Ct.$on=Dt.on,Ct.$off=Dt.off,Ct.$emit=Dt.emit;var Tt=Ct;const Ht=(0,n.ri)(Wt);Ht.config.globalProperties.$bus=Tt,Ht.mount("#app")}},e={};function a(n){var o=e[n];if(void 0!==o)return o.exports;var l=e[n]={exports:{}};return t[n].call(l.exports,l,l.exports,a),l.exports}a.m=t,function(){var t=[];a.O=function(e,n,o,l){if(!n){var i=1/0;for(d=0;d<t.length;d++){n=t[d][0],o=t[d][1],l=t[d][2];for(var r=!0,s=0;s<n.length;s++)(!1&l||i>=l)&&Object.keys(a.O).every((function(t){return a.O[t](n[s])}))?n.splice(s--,1):(r=!1,l<i&&(i=l));if(r){t.splice(d--,1);var u=o();void 0!==u&&(e=u)}}return e}l=l||0;for(var d=t.length;d>0&&t[d-1][2]>l;d--)t[d]=t[d-1];t[d]=[n,o,l]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,n){var o,l,i=n[0],r=n[1],s=n[2],u=0;if(i.some((function(e){return 0!==t[e]}))){for(o in r)a.o(r,o)&&(a.m[o]=r[o]);if(s)var d=s(a)}for(e&&e(n);u<i.length;u++)l=i[u],a.o(t,l)&&t[l]&&t[l][0](),t[l]=0;return a.O(d)},n=self["webpackChunkgpxbox"]=self["webpackChunkgpxbox"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(2661)}));n=a.O(n)})();
//# sourceMappingURL=app.35ad22ae.js.map